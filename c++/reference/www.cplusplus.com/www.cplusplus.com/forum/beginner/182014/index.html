<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>std::copy kind of not working - C++ Forum</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/forum/">Forum</a></li>
<li><a href="/forum/beginner/">Beginners</a></li>
<li class="here">std::copy kind of not working</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div class="C_support">
<div id='div-gpt-ad-1427191279638-0' style='width:728px; height:90px;'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1427191279638-0'); });
</script>
</div>
</div>
<div id="I_content">
<h3><div class="C_ico solved" title="solved">&nbsp;</div> std::copy kind of not working</h3><span id="CH_edttl"></span><span class="rootdatPost" title="182014,root,0,-1,8,0"></span><div id="CH_PostList"><div class="C_forPost" id="msg892346"><span title="892346,18075,1023,311,1"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892346" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTme2124eac12" title="Fri, 01 Jan 2016 15:43:06 +0000"></span><script type="text/javascript">WhenId('CH_zTme2124eac12');</script><noscript>Jan 1, 2016 at 3:43pm UTC</noscript></div>
<div class="dwho"><a href="/user/etrusks/"><b>etrusks</b> (311)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892346">
Hi, I tried to copy array of chars into string but for some reason it didn't work<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br></code></pre></td>
<td class="source"><pre><code><dfn>#include &lt;iostream&gt;</dfn>
<dfn>#include &lt;string&gt;</dfn>
<dfn>#include &lt;algorithm&gt;</dfn>
<dfn>#include &lt;cstring&gt;</dfn>

<var>int</var> main()
{
  <var>const</var> <var>char</var>* text= <kbd>"Example text"</kbd>;
  std::string str;
  <var>unsigned</var> <var>int</var> text_lenght = std::strlen(text);
  
  str.reserve(text_lenght);
  std::copy(&amp;text[0], &amp;text[0] + text_lenght, str.begin());  <cite>//whats wrong with this line?</cite>
  
  std::cout &lt;&lt; <kbd>" copied string = "</kbd> &lt;&lt; str &lt;&lt; std::endl;
  
  <var>return</var> 0;
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
output : <br>
<div class="auto"><table class="snippet"><tr><td class="output"><pre><samp>copied string = </samp></pre></td></tr></table></div><br>
<br>
Later on I found that I can simply use <span class="auto"><code class="source">std::string str(text);</code></span> and it works fine and I should probably use it. But I cant seem to understand why the previous code didn't work. Any ideas?
</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTm01a4357e1e" title="Fri, 01 Jan 2016 15:44:35 +0000"></span><script type="text/javascript">WhenId('CH_zTm01a4357e1e');</script><noscript>Jan 1, 2016 at 3:44pm UTC</noscript></span>
<span class="dbtn" id="CH_btn892346"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892351"><span title="892351,143106,1023,319,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892351" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTmfd92ebc08d" title="Fri, 01 Jan 2016 16:01:13 +0000"></span><script type="text/javascript">WhenId('CH_zTmfd92ebc08d');</script><noscript>Jan 1, 2016 at 4:01pm UTC</noscript></div>
<div class="dwho"><a href="/user/koothkeeper/"><b>koothkeeper</b> (319)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892351">
You can't use any of the std::copy on C strings (char *).
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892351"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892352"><span title="892352,97037,1023,1903,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892352" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm45e2da596e" title="Fri, 01 Jan 2016 16:03:54 +0000"></span><script type="text/javascript">WhenId('CH_zTm45e2da596e');</script><noscript>Jan 1, 2016 at 4:03pm UTC</noscript></div>
<div class="dwho"><a href="/user/jlb/"><b>jlb</b> (1903)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892352">
Actually it's not the std::copy line that is the problem, it is the str.reserve() line that is the problem. The reserve() method only increases the capacity of the string it doesn't actually change the size of the string. You need to use resize() instead.<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br></code></pre></td>
<td class="source"><pre><code> str.resize(text_lenght);
  std::copy(text, text + text_lenght, str.begin()); </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Also you don't really need the &amp;text[0], all you really need is the name.
</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTm355839bfe6" title="Fri, 01 Jan 2016 16:04:21 +0000"></span><script type="text/javascript">WhenId('CH_zTm355839bfe6');</script><noscript>Jan 1, 2016 at 4:04pm UTC</noscript></span>
<span class="dbtn" id="CH_btn892352"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892354"><span title="892354,199131,1023,610,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892354" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm7850e20e29" title="Fri, 01 Jan 2016 16:09:42 +0000"></span><script type="text/javascript">WhenId('CH_zTm7850e20e29');</script><noscript>Jan 1, 2016 at 4:09pm UTC</noscript></div>
<div class="dwho"><a href="/user/Thomas1965/"><b>Thomas1965</b> (610)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892354">
@koothkeeper,<br>
<br>
you can use stl algorithms with "normal" arrays. <br>
The algorithms need iterators and in many cases  a pointer can be used as an iterator. I am not sure if there are exceptions.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892354"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892357"><span title="892357,18075,1023,311,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892357" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTmfd621c6d68" title="Fri, 01 Jan 2016 16:15:16 +0000"></span><script type="text/javascript">WhenId('CH_zTmfd621c6d68');</script><noscript>Jan 1, 2016 at 4:15pm UTC</noscript></div>
<div class="dwho"><a href="/user/etrusks/"><b>etrusks</b> (311)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892357">
Ohh man! Tnx a lot guys for you help :)
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892357"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892365"><span title="892365,143106,1023,319,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892365" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTmc61fe1b2b9" title="Fri, 01 Jan 2016 17:10:19 +0000"></span><script type="text/javascript">WhenId('CH_zTmc61fe1b2b9');</script><noscript>Jan 1, 2016 at 5:10pm UTC</noscript></div>
<div class="dwho"><a href="/user/koothkeeper/"><b>koothkeeper</b> (319)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892365">
@Thomas1965: Thanks!  I learn something new every day.  
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892365"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892373"><span title="892373,37152,1023,8201,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892373" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm7f3cb41ce1" title="Fri, 01 Jan 2016 18:10:52 +0000"></span><script type="text/javascript">WhenId('CH_zTm7f3cb41ce1');</script><noscript>Jan 1, 2016 at 6:10pm UTC</noscript></div>
<div class="dwho"><a href="/user/ne555/"><b>ne555</b> (8201)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892373">
Or you can use an insert iterator<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br></code></pre></td>
<td class="source"><pre><code>	str.reserve(text_length);
	std::copy(
		text,
		text+text_length,
		std::back_inserter(str)
	);</code></pre></td><td class="C_btnholder"></td></tr></table></div>
the iterator would call `.pushback()' on the container, so don't have to `.resize()'<br>
( `.reserve()' would be only an optimization to avoid reallocation, but can be omited)
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892373"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892398"><span title="892398,18075,1023,311,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892398" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm0e6df46201" title="Fri, 01 Jan 2016 20:42:37 +0000"></span><script type="text/javascript">WhenId('CH_zTm0e6df46201');</script><noscript>Jan 1, 2016 at 8:42pm UTC</noscript></div>
<div class="dwho"><a href="/user/etrusks/"><b>etrusks</b> (311)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892398">
Cool man. First time I actually see something like this. Much appreciated :)
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892398"></span>

</div>
</div>
</div>
</div><div class="rootinsMore"></div><div class="rootbtnMore"></div><div class="rootinsNew"></div><div class="rootbtnNew"></div><div id="CH_insNew"></div><div id="CH_reply">Registered users can post here. <a href="/user/">Sign in or register</a> to post.</div><div id="CH_subscription"></div><div class="rootedtNew"></div><script type="text/javascript">new for_PostList(182014,0,18075,1,'CH_PostList','CH_subscription','CH_reply','CH_insNew','CH_edttl','/forum/thread.cgi','/forum/post.cgi','/forum/myposts.cgi',64,32,512,256,1024,16);</script></div>
</div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder articles"><a href="/articles/">Articles</a></li>
<li class="folder selected forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/forum/">Forum</a></b></h3>
<ul>
<li class="selected"><a href="/forum/beginner/"><b>Beginners</b></a></li><li><a href="/forum/windows/"><b>Windows Programming</b></a></li><li><a href="/forum/unices/"><b>UNIX/Linux Programming</b></a></li><li><a href="/forum/general/"><b>General C++ Programming</b></a></li><li><a href="/forum/lounge/"><b>Lounge</b></a></li><li><a href="/forum/jobs/"><b>Jobs</b></a></li></ul>
</div>
<div id="I_subnav"></div>
<div class="C_ad234">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7445514729";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Fforum%2Fbeginner%2F182014%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
function NavFor(us) {document.getElementById('I_subnav').innerHTML=us.ok?'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul><li><a href="/forum/myposts.cgi">My topics</a></li></ul></div>':'';}onSession(NavFor);ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>