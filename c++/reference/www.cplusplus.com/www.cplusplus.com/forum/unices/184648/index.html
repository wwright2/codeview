<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Duplicate couts and missed code - C++ Forum</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/forum/">Forum</a></li>
<li><a href="/forum/unices/">UNIX/Linux Programming</a></li>
<li class="here">Duplicate couts and missed code</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div class="C_support">
<div id='div-gpt-ad-1427191279638-0' style='width:728px; height:90px;'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1427191279638-0'); });
</script>
</div>
</div>
<div id="I_content">
<h3><div class="C_ico solved" title="solved">&nbsp;</div> Duplicate couts and missed code</h3><span id="CH_edttl"></span><span class="rootdatPost" title="184648,root,0,-1,3,0"></span><div id="CH_PostList"><div class="C_forPost" id="msg902513"><span title="902513,128094,1023,6,1"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg902513" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTmfd39914f28" title="Mon, 15 Feb 2016 20:52:01 +0000"></span><script type="text/javascript">WhenId('CH_zTmfd39914f28');</script><noscript>Feb 15, 2016 at 8:52pm UTC</noscript></div>
<div class="dwho"><a href="/user/Animegato88/"><b>Animegato88</b> (6)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i902513">
Hello, <br>
<br>
I'm creating a program that runs on Linux and deals with getpid(), getppid(), fork(), wait(), and sleep() functions. For some reason, my cout lines duplicate in the output, and the bottom portion of my code doesn't run at all. I'm sure it has something to do with the other exit codes, but I'm not sure how to fix it. Can anyone help me?<br>
<br>
#include &lt;iostream&gt;<br>
#include &lt;cstdlib&gt;<br>
#include &lt;unistd.h&gt;<br>
#include &lt;sys/types.h&gt;<br>
#include &lt;sys/wait.h&gt;<br>
<br>
using namespace std;<br>
<br>
int main()<br>
{<br>
   pid_t pid, childpid;<br>
   cout&lt;&lt;"The beginning process name is "&lt;&lt;getpid()&lt;&lt;endl;//gets and prints the main process<br>
   cout&lt;&lt;"The beginning parent process is "&lt;&lt;getppid()&lt;&lt;endl&lt;&lt;endl;//gets and prints the parent process<br>
   pid = fork();//creates 2 processes (parent and child)<br>
   childpid = fork();//creates 2 processes (child and grandchild)<br>
<br>
   //If the parent fork fails, print an error message and exit<br>
   if(pid &lt; 0)<br>
   {<br>
      cerr&lt;&lt;"A fork error occurred. Ending program."&lt;&lt;endl;<br>
      exit(-1);<br>
   }<br>
   else<br>
   {<br>
      //Print the id of the child and parent process id<br>
      cout&lt;&lt;"This is in the child process, PID of "&lt;&lt;getpid()&lt;&lt;endl;<br>
      cout&lt;&lt;"The parent PID of the child process is "&lt;&lt;getppid&lt;&lt;endl;<br>
      if(childpid &lt; 0)<br>
      {<br>
         //if the child fork fails, print an error message and exit<br>
         cerr&lt;&lt;"The second fork failed."&lt;&lt;endl;<br>
         exit(-1);<br>
      }<br>
      else<br>
      {<br>
         //print the grandchild and child ids and exit from grandchild.<br>
         cout&lt;&lt;"We're in the grandchild process, value of "&lt;&lt;getpid()&lt;&lt;"."&lt;&lt;endl;<br>
         cout&lt;&lt;"The PID of grandchild's parent is "&lt;&lt;getppid()&lt;&lt;"."&lt;&lt;endl;<br>
         cout&lt;&lt;"We will now exit the program from grandchild."&lt;&lt;endl;<br>
         exit(0);<br>
      }<br>
      cout&lt;&lt;"This is the child process, PID of "&lt;&lt;getpid()&lt;&lt;endl;<br>
      cout&lt;&lt;"The parent PID is "&lt;&lt;getppid()&lt;&lt;endl;<br>
      wait(0);//wait for grandchild to terminate<br>
      cout&lt;&lt;"We're about to exit the child process."&lt;&lt;endl;<br>
      exit(0);//exit from child<br>
   }<br>
<br>
   cout&lt;&lt;"This is the parent process, ID of "&lt;&lt;getpid()&lt;&lt;endl;<br>
   cout&lt;&lt;"The parent of the parent is "&lt;&lt;getppid()&lt;&lt;endl;<br>
   sleep(2);//sleep for 2 seconds<br>
   cout&lt;&lt;"Parent is awake and will now call the ps function."&lt;&lt;endl;<br>
   system("ps");//call the ps Linux command<br>
   wait(0);//wait for child to terminate<br>
   cout&lt;&lt;"Ending parent, about to terminate."&lt;&lt;endl;<br>
   exit(0);//exit from parent<br>
<br>
   exit(0);<br>
}
</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTme478149f94" title="Mon, 15 Feb 2016 20:56:51 +0000"></span><script type="text/javascript">WhenId('CH_zTme478149f94');</script><noscript>Feb 15, 2016 at 8:56pm UTC</noscript></span>
<span class="dbtn" id="CH_btn902513"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg902766"><span title="902766,11103,1023,4532,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg902766" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm8c75129aa5" title="Tue, 16 Feb 2016 18:30:43 +0000"></span><script type="text/javascript">WhenId('CH_zTm8c75129aa5');</script><noscript>Feb 16, 2016 at 6:30pm UTC</noscript></div>
<div class="dwho"><a href="/user/Zhuge/"><b>Zhuge</b> (4532)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i902766">
Could you add some code tags? Also, a copy of the output as well as the expected output would make it easier to debug.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn902766"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg902775"><span title="902775,97037,1023,1903,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg902775" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm6ed8fc9f18" title="Tue, 16 Feb 2016 19:07:54 +0000"></span><script type="text/javascript">WhenId('CH_zTm6ed8fc9f18');</script><noscript>Feb 16, 2016 at 7:07pm UTC</noscript></div>
<div class="dwho"><a href="/user/jlb/"><b>jlb</b> (1903)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i902775">
Do you realize that when your program encounters exit() the program stops and exits to the operating system and none of the code following the exit() is executed?<br>
<br>

</div>
<div class="dhow">
<span class="dbtn" id="CH_btn902775"></span>

</div>
</div>
</div>
</div><div class="rootinsMore"></div><div class="rootbtnMore"></div><div class="rootinsNew"></div><div class="rootbtnNew"></div><div id="CH_insNew"></div><div id="CH_reply">Registered users can post here. <a href="/user/">Sign in or register</a> to post.</div><div id="CH_subscription"></div><div class="rootedtNew"></div><script type="text/javascript">new for_PostList(184648,0,128094,1,'CH_PostList','CH_subscription','CH_reply','CH_insNew','CH_edttl','/forum/thread.cgi','/forum/post.cgi','/forum/myposts.cgi',64,32,512,256,1024,16);</script></div>
</div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder articles"><a href="/articles/">Articles</a></li>
<li class="folder selected forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/forum/">Forum</a></b></h3>
<ul>
<li><a href="/forum/beginner/"><b>Beginners</b></a></li><li><a href="/forum/windows/"><b>Windows Programming</b></a></li><li class="selected"><a href="/forum/unices/"><b>UNIX/Linux Programming</b></a></li><li><a href="/forum/general/"><b>General C++ Programming</b></a></li><li><a href="/forum/lounge/"><b>Lounge</b></a></li><li><a href="/forum/jobs/"><b>Jobs</b></a></li></ul>
</div>
<div id="I_subnav"></div>
<div class="C_ad234">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7445514729";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Fforum%2Funices%2F184648%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
function NavFor(us) {document.getElementById('I_subnav').innerHTML=us.ok?'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul><li><a href="/forum/myposts.cgi">My topics</a></li></ul></div>':'';}onSession(NavFor);ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>