<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Visual Studio 2015 Oracle exception debu - C++ Forum</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/forum/">Forum</a></li>
<li><a href="/forum/windows/">Windows Programming</a></li>
<li class="here">Visual Studio 2015 Oracle exception debu</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div class="C_support">
<div id='div-gpt-ad-1427191279638-0' style='width:728px; height:90px;'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1427191279638-0'); });
</script>
</div>
</div>
<div id="I_content">
<h3><div class="C_ico solved" title="solved">&nbsp;</div> Visual Studio 2015 Oracle exception debug assertion</h3><span id="CH_edttl"></span><span class="rootdatPost" title="182330,root,0,-1,13,0"></span><div id="CH_PostList"><div class="C_forPost" id="msg893542"><span title="893542,79528,1023,99,1"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893542" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm87af05a927" title="Thu, 07 Jan 2016 19:38:20 +0000"></span><script type="text/javascript">WhenId('CH_zTm87af05a927');</script><noscript>Jan 7, 2016 at 7:38pm UTC</noscript></div>
<div class="dwho"><a href="/user/AcarX/"><b>AcarX</b> (99)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893542">
I'm using Visual Studio 2015 Enterprise with Oracle 12.1.0. Here's the code causing assertion:<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br></code></pre></td>
<td class="source"><pre><code><var>try</var>
{
    <cite>// ..</cite>
}<var>catch</var>(oracle::occi::SQLException &amp;e)
{
    std::cout &lt;&lt; <kbd>"Error code: "</kbd> &lt;&lt; e.getErrorCode() &lt;&lt; std::endl;
    std::cout &lt;&lt; <kbd>"Error message: "</kbd> &lt;&lt; e.getMessage() &lt;&lt; std::endl;   <cite>// Most likely here </cite>
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Debug assertion: __acrt_first_block == header<br>
I'm assuming it has something to do with std::string being allocated by dll and deallocated by application but I'm not sure. Also I got no idea on how to fix it.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893542"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893667"><span title="893667,39415,1023,5467,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893667" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm9cc92a1b74" title="Fri, 08 Jan 2016 12:11:40 +0000"></span><script type="text/javascript">WhenId('CH_zTm9cc92a1b74');</script><noscript>Jan 8, 2016 at 12:11pm UTC</noscript></div>
<div class="dwho"><a href="/user/coder777/"><b>coder777</b> (5467)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893667">
It has probable to do with the reference<br>
<br>
<span class="auto"><code class="source"><var>catch</var>(oracle::occi::SQLException <u>&amp;</u>e)</code></span><br>
<br>
<br>
I rarly use exception, but I would guess that the exception is no longer valid at that point. Try changing it to<br>
<br>
<span class="auto"><code class="source"><var>catch</var>(<u><var>const</var></u> oracle::occi::SQLException &amp;e)</code></span>
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893667"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893671"><span title="893671,79528,1023,99,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893671" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm1ee8c8a22c" title="Fri, 08 Jan 2016 12:32:00 +0000"></span><script type="text/javascript">WhenId('CH_zTm1ee8c8a22c');</script><noscript>Jan 8, 2016 at 12:32pm UTC</noscript></div>
<div class="dwho"><a href="/user/AcarX/"><b>AcarX</b> (99)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893671">
Thanks for the reply. That didn't work sadly. ::getMessage returns the error string as expected but crashes at deallocator.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893671"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893684"><span title="893684,199131,1023,610,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893684" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm60e67bce09" title="Fri, 08 Jan 2016 14:07:23 +0000"></span><script type="text/javascript">WhenId('CH_zTm60e67bce09');</script><noscript>Jan 8, 2016 at 2:07pm UTC</noscript></div>
<div class="dwho"><a href="/user/Thomas1965/"><b>Thomas1965</b> (610)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893684">
You could try <br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br></code></pre></td>
<td class="source"><pre><code><var>catch</var>(oracle::occi::SQLException &amp;e)
{
    std::cout &lt;&lt; <kbd>"Error code: "</kbd> &lt;&lt; e.getErrorCode() &lt;&lt; std::endl;
    std::cout &lt;&lt; <kbd>"Error message: "</kbd> &lt;&lt; e.what() &lt;&lt; std::endl;   <cite>// Most likely here </cite>
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>

</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893684"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893694"><span title="893694,79528,1023,99,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893694" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm9a4b3e4d87" title="Fri, 08 Jan 2016 15:13:18 +0000"></span><script type="text/javascript">WhenId('CH_zTm9a4b3e4d87');</script><noscript>Jan 8, 2016 at 3:13pm UTC</noscript></div>
<div class="dwho"><a href="/user/AcarX/"><b>AcarX</b> (99)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893694">
@Thomas1965 Wow thank you very much that did the trick.  <br>
<br>
Although there're still some issues. For example if I want to use ResultSet::getString(..) I'll probably still get the error. How would I go about fixing that?
</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTm7ada972bcc" title="Fri, 08 Jan 2016 15:16:23 +0000"></span><script type="text/javascript">WhenId('CH_zTm7ada972bcc');</script><noscript>Jan 8, 2016 at 3:16pm UTC</noscript></span>
<span class="dbtn" id="CH_btn893694"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893713"><span title="893713,199131,1023,610,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893713" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm0ecc9fab13" title="Fri, 08 Jan 2016 16:59:41 +0000"></span><script type="text/javascript">WhenId('CH_zTm0ecc9fab13');</script><noscript>Jan 8, 2016 at 4:59pm UTC</noscript></div>
<div class="dwho"><a href="/user/Thomas1965/"><b>Thomas1965</b> (610)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893713">
Glad that it worked. <br>
<br>
What did the error actually say? <br>
<br>
I guess you need to fix the error first.<br>

</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893713"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893739"><span title="893739,79528,1023,99,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893739" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm3b9afa2ef8" title="Fri, 08 Jan 2016 19:03:25 +0000"></span><script type="text/javascript">WhenId('CH_zTm3b9afa2ef8');</script><noscript>Jan 8, 2016 at 7:03pm UTC</noscript></div>
<div class="dwho"><a href="/user/AcarX/"><b>AcarX</b> (99)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893739">
It says "Debug assertion failed" with __acrt_first_block == header. Breakpoint is at the end of <span class="auto"><code class="source"><var>void</var> _Deallocate(<var>void</var> * _Ptr, size_t _Count, size_t _Sz);</code></span> function in xmemory0 where it calls <span class="auto"><code class="source">::<var>operator</var> <var>delete</var>(_Ptr);</code></span>
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893739"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893759"><span title="893759,199131,1023,610,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893759" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm93f209b822" title="Fri, 08 Jan 2016 21:23:43 +0000"></span><script type="text/javascript">WhenId('CH_zTm93f209b822');</script><noscript>Jan 8, 2016 at 9:23pm UTC</noscript></div>
<div class="dwho"><a href="/user/Thomas1965/"><b>Thomas1965</b> (610)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893759">
<table class="quote"><tr><td class="qd">It says "Debug assertion failed" with __acrt_first_block == header. Breakpoint is at the end of void _Deallocate(void * _Ptr, size_t _Count, size_t _Sz); function in xmemory0 where it calls ::operator delete(_Ptr);</td></tr></table><br>
<br>
Sorry I was not clear enough. I ment the msg in e.what(). Could you maybe post some code between the try and catch block? My guess is that there is some error before which actually leads to the exception thrown.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893759"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893760"><span title="893760,79528,1023,99,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893760" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm83383b1e38" title="Fri, 08 Jan 2016 21:30:23 +0000"></span><script type="text/javascript">WhenId('CH_zTm83383b1e38');</script><noscript>Jan 8, 2016 at 9:30pm UTC</noscript></div>
<div class="dwho"><a href="/user/AcarX/"><b>AcarX</b> (99)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893760">
Oh database connection was failing so that was the reason of exception. Overall library works as expected it's just std::string related functions. They work but crash at deallocation.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893760"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893787"><span title="893787,38650,1023,2141,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893787" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm7803f2e9d4" title="Fri, 08 Jan 2016 23:57:25 +0000"></span><script type="text/javascript">WhenId('CH_zTm7803f2e9d4');</script><noscript>Jan 8, 2016 at 11:57pm UTC</noscript></div>
<div class="dwho"><a href="/user/naraku9333/"><b>naraku9333</b> (2141)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893787">
I agree with PaulMcKenzie in your SO post <a href="http://stackoverflow.com/questions/34662466/oracle-exception-getmessage-causing-debug-assertion">http://stackoverflow.com/questions/34662466/oracle-exception-getmessage-causing-debug-assertion</a><br>
<br>
It doesn't look like occi supports VS 2015 yet.<br>
<br>

</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893787"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893791"><span title="893791,79528,1023,99,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893791" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm4beacf4916" title="Sat, 09 Jan 2016 00:48:38 +0000"></span><script type="text/javascript">WhenId('CH_zTm4beacf4916');</script><noscript>Jan 9, 2016 at 12:48am UTC</noscript></div>
<div class="dwho"><a href="/user/AcarX/"><b>AcarX</b> (99)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893791">
I guess I'll have to keep using vc12 until they release vc14 version then..
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn893791"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg893794"><span title="893794,38650,1023,2141,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg893794" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm301a856242" title="Sat, 09 Jan 2016 01:12:51 +0000"></span><script type="text/javascript">WhenId('CH_zTm301a856242');</script><noscript>Jan 9, 2016 at 1:12am UTC</noscript></div>
<div class="dwho"><a href="/user/naraku9333/"><b>naraku9333</b> (2141)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i893794">
Maybe give this a try <a href="http://www.oracle.com/technetwork/developer-tools/visual-studio/overview/index-097110.html">http://www.oracle.com/technetwork/developer-tools/visual-studio/overview/index-097110.html</a><br>
it says it supports 2015.<br>
<br>
EDIT: Actually after a closer look, it seems it's .Net only.
</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTmdf925ea068" title="Sat, 09 Jan 2016 01:16:29 +0000"></span><script type="text/javascript">WhenId('CH_zTmdf925ea068');</script><noscript>Jan 9, 2016 at 1:16am UTC</noscript></span>
<span class="dbtn" id="CH_btn893794"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg899240"><span title="899240,210455,255,1,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg899240" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm89c7634dbb" title="Wed, 03 Feb 2016 10:32:26 +0000"></span><script type="text/javascript">WhenId('CH_zTm89c7634dbb');</script><noscript>Feb 3, 2016 at 10:32am UTC</noscript></div>
<div class="dwho"><a href="/user/kmohan/"><b>kmohan</b> (1)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i899240">
OCCI 12cR1 is supported with VS2010, VS2012 and VS2013. Not with VS2015. Please see <a href="https://docs.oracle.com/database/121/NTCLI/pre_install.htm#NTCLI1252">https://docs.oracle.com/database/121/NTCLI/pre_install.htm#NTCLI1252</a>
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn899240"></span>

</div>
</div>
</div>
</div><div class="rootinsMore"></div><div class="rootbtnMore"></div><div class="rootinsNew"></div><div class="rootbtnNew"></div><div id="CH_insNew"></div><div id="CH_reply">Registered users can post here. <a href="/user/">Sign in or register</a> to post.</div><div id="CH_subscription"></div><div class="rootedtNew"></div><script type="text/javascript">new for_PostList(182330,0,79528,1,'CH_PostList','CH_subscription','CH_reply','CH_insNew','CH_edttl','/forum/thread.cgi','/forum/post.cgi','/forum/myposts.cgi',64,32,512,256,1024,16);</script></div>
<script type="text/javascript">
    google_ad_client = "ca-pub-1444228343479937";
    google_ad_slot = "9701143201";
    google_ad_width = 728;
    google_ad_height = 90;
</script>
<!-- leaderboard -->
<script type="text/javascript"
src="//pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder articles"><a href="/articles/">Articles</a></li>
<li class="folder selected forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/forum/">Forum</a></b></h3>
<ul>
<li><a href="/forum/beginner/"><b>Beginners</b></a></li><li class="selected"><a href="/forum/windows/"><b>Windows Programming</b></a></li><li><a href="/forum/unices/"><b>UNIX/Linux Programming</b></a></li><li><a href="/forum/general/"><b>General C++ Programming</b></a></li><li><a href="/forum/lounge/"><b>Lounge</b></a></li><li><a href="/forum/jobs/"><b>Jobs</b></a></li></ul>
</div>
<div id="I_subnav"></div>
<div class="C_ad234">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7445514729";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Fforum%2Fwindows%2F182330%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
function NavFor(us) {document.getElementById('I_subnav').innerHTML=us.ok?'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul><li><a href="/forum/myposts.cgi">My topics</a></li></ul></div>':'';}onSession(NavFor);ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>