<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>E_NOINTERFACE - C++ Forum</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/forum/">Forum</a></li>
<li><a href="/forum/windows/">Windows Programming</a></li>
<li class="here">E_NOINTERFACE</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div class="C_support">
<div id='div-gpt-ad-1427191279638-0' style='width:728px; height:90px;'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1427191279638-0'); });
</script>
</div>
</div>
<div id="I_content">
<h3><div class="C_ico default" title="post">&nbsp;</div> E_NOINTERFACE</h3><span id="CH_edttl"></span><span class="rootdatPost" title="182108,root,0,-1,2,0"></span><div id="CH_PostList"><div class="C_forPost" id="msg892674"><span title="892674,70350,1023,100,1"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892674" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm035fae7f84" title="Sun, 03 Jan 2016 07:20:16 +0000"></span><script type="text/javascript">WhenId('CH_zTm035fae7f84');</script><noscript>Jan 3, 2016 at 7:20am UTC</noscript></div>
<div class="dwho"><a href="/user/JAI_SINGH/"><b>JAI SINGH</b> (100)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892674">
Hi,<br>
I am using StgOpenStorageEx to open a file but it gives me the error <br>
E_NOINTERFACE.<br>
<br>
below is the code snippet<br>
<br>
LpStorage lpstor;<br>
IPropertySetStorage* pPropSetStg = NULL;//TEMPJAI<br>
	<br>
<br>
DWORD dw = StgOpenStorageEx(L"C:\\ETools\\Power Generation\\Shared\\Data\\AllCtrl.dfa", STGM_READ | STGM_SHARE_DENY_WRITE, STGFMT_FILE, 0, 0, 0, IID_IStorage, reinterpret_cast&lt;void**&gt;(&amp;pPropSetStg));<br>
<br>
I just want to know what is wrong with this code.<br>
<br>

</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892674"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg892712"><span title="892712,13185,1023,1354,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg892712" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm5baaa3937c" title="Sun, 03 Jan 2016 15:24:18 +0000"></span><script type="text/javascript">WhenId('CH_zTm5baaa3937c');</script><noscript>Jan 3, 2016 at 3:24pm UTC</noscript></div>
<div class="dwho"><a href="/user/freddie1/"><b>freddie1</b> (1354)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i892712">
Doubt this is your problem, but all COM functions return HRESULTs - not DWORDs.  Its been quite a while since I've worked with structured storage, and when I did I was likely using StgOpenStorage().  Without looking into it any further, my guess would be to examine and play around with the enumeration parameters, i.e., specifically the 2nd and 3rd ones, and also the ones where you are passing in zeros.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn892712"></span>

</div>
</div>
</div>
</div><div class="rootinsMore"></div><div class="rootbtnMore"></div><div class="rootinsNew"></div><div class="rootbtnNew"></div><div id="CH_insNew"></div><div id="CH_reply">Registered users can post here. <a href="/user/">Sign in or register</a> to post.</div><div id="CH_subscription"></div><div class="rootedtNew"></div><script type="text/javascript">new for_PostList(182108,0,70350,0,'CH_PostList','CH_subscription','CH_reply','CH_insNew','CH_edttl','/forum/thread.cgi','/forum/post.cgi','/forum/myposts.cgi',64,32,512,256,1024,16);</script></div>
</div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder articles"><a href="/articles/">Articles</a></li>
<li class="folder selected forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/forum/">Forum</a></b></h3>
<ul>
<li><a href="/forum/beginner/"><b>Beginners</b></a></li><li class="selected"><a href="/forum/windows/"><b>Windows Programming</b></a></li><li><a href="/forum/unices/"><b>UNIX/Linux Programming</b></a></li><li><a href="/forum/general/"><b>General C++ Programming</b></a></li><li><a href="/forum/lounge/"><b>Lounge</b></a></li><li><a href="/forum/jobs/"><b>Jobs</b></a></li></ul>
</div>
<div id="I_subnav"></div>
<div class="C_ad234">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7445514729";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Fforum%2Fwindows%2F182108%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
function NavFor(us) {document.getElementById('I_subnav').innerHTML=us.ok?'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul><li><a href="/forum/myposts.cgi">My topics</a></li></ul></div>':'';}onSession(NavFor);ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>