<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>C++ Memory Counting - C++ Forum</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/forum/">Forum</a></li>
<li><a href="/forum/windows/">Windows Programming</a></li>
<li class="here">C++ Memory Counting</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div class="C_support">
<div id='div-gpt-ad-1427191279638-0' style='width:728px; height:90px;'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1427191279638-0'); });
</script>
</div>
</div>
<div id="I_content">
<h3><div class="C_ico default" title="post">&nbsp;</div> C++ Memory Counting</h3><span id="CH_edttl"></span><span class="rootdatPost" title="153638,root,0,-1,3,0"></span><div id="CH_PostList"><div class="C_forPost" id="msg795646"><span title="795646,131476,1023,5,1"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg795646" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTmf9033841b2" title="Fri, 16 Jan 2015 10:26:05 +0000"></span><script type="text/javascript">WhenId('CH_zTmf9033841b2');</script><noscript>Jan 16, 2015 at 10:26am UTC</noscript></div>
<div class="dwho"><a href="/user/MrDaniel/"><b>MrDaniel</b> (5)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i795646">
Hello,<br>
<br>
I have been working on an OpenCV project that uses the grand central dispatch pattern, libdispatch. I have asked at both the OpenCV forum and lisdispatch forum, but sources said that this is a more general C++ issue.<br>
<br>
<a href="http://opencv.org/">http://opencv.org/</a><br>
<br>
<a href="http://opensource.mlba-team.de/xdispatch/docs/current/index.html">http://opensource.mlba-team.de/xdispatch/docs/current/index.html</a><br>
<br>
Anyway, i've made a neat little application that does image processing. Libdispatch has a series a of task queues that can recieve new data and perform a task.<br>
<br>
What are the correct ways to count memory? Let's say we have 2 users each running a task queue. One user has paid to have 2Gb of RAM available to them at any one time. The other, has 4Gb. How can i count the memory between threads?<br>
<br>
I am thinking along two lines... but, the issue arises of how to manage and control at this level with C++.<br>
<br>
1) Do i mark each task type with some or of multiplier. i.e. Convertcolour uses X memory, and i want to convert and image. image size * cost per task.<br>
<br>
2) Continually check how much memory has been allocated so far.<br>
<br>
Basically i want to create a paid image processing service, that does not expand beyond the capacity that has been paid for.<br>
<br>
Any clever ideas for this?<br>
<br>
Regards,<br>
<br>
Daniel<br>
<br>
Visual Studio 2012<br>
OpenCV<br>
xDispatch<br>

</div>
<div class="dhow">
<span class="dbtn" id="CH_btn795646"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg795684"><span title="795684,17129,1023,7936,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg795684" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTmb1e30891f4" title="Fri, 16 Jan 2015 14:33:54 +0000"></span><script type="text/javascript">WhenId('CH_zTmb1e30891f4');</script><noscript>Jan 16, 2015 at 2:33pm UTC</noscript></div>
<div class="dwho"><a href="/user/kbw/"><b>kbw</b> (7936)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i795684">
It's best to run the tasks as separate processes, then you can collect metrics or place limits on each process.  Let the OS do what it does best.  It's tricky to manage within one process.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn795684"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg795688"><span title="795688,29924,1023,5406,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg795688" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm4ff4a9c09c" title="Fri, 16 Jan 2015 15:04:46 +0000"></span><script type="text/javascript">WhenId('CH_zTm4ff4a9c09c');</script><noscript>Jan 16, 2015 at 3:04pm UTC</noscript></div>
<div class="dwho"><a href="/user/Computergeek01/"><b>Computergeek01</b> (5406)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i795688">
First and foremost; charging by memory allocation is a <u><i>terrible</i></u> business model, RAM is cheap and you can't guarantee performance so there is next to zero QoS control on what is being paid for. The widely excepted model is to charge by processor core allocation and\or non-volatile storage. <br>
<br>
Second, I agree with <b>kbw</b> 100%, you should let the OS handle this and not worry about coding it yourself. Specifically what he means is that memory quotas are set via group policy on a <i>per user</i> basis which is exactly what you are asking for here: <a href="http://technet.microsoft.com/en-us/library/dn221983(v=ws.10).aspx">http://technet.microsoft.com/en-us/library/dn221983(v=ws.10).aspx</a>
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn795688"></span>

</div>
</div>
</div>
</div><div class="rootinsMore"></div><div class="rootbtnMore"></div><div class="rootinsNew"></div><div class="rootbtnNew"></div><div id="CH_insNew"></div><div id="CH_reply">Topic archived. No new replies allowed.</div><div id="CH_subscription"></div><div class="rootedtNew"></div><script type="text/javascript">new for_PostList(153638,1,131476,0,'CH_PostList','CH_subscription','CH_reply','CH_insNew','CH_edttl','/forum/thread.cgi','/forum/post.cgi','/forum/myposts.cgi',64,32,512,256,1024,16);</script></div>
</div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder articles"><a href="/articles/">Articles</a></li>
<li class="folder selected forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/forum/">Forum</a></b></h3>
<ul>
<li><a href="/forum/beginner/"><b>Beginners</b></a></li><li class="selected"><a href="/forum/windows/"><b>Windows Programming</b></a></li><li><a href="/forum/unices/"><b>UNIX/Linux Programming</b></a></li><li><a href="/forum/general/"><b>General C++ Programming</b></a></li><li><a href="/forum/lounge/"><b>Lounge</b></a></li><li><a href="/forum/jobs/"><b>Jobs</b></a></li></ul>
</div>
<div id="I_subnav"></div>
<div class="C_ad234">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7445514729";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Fforum%2Fwindows%2F153638%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
function NavFor(us) {document.getElementById('I_subnav').innerHTML=us.ok?'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul><li><a href="/forum/myposts.cgi">My topics</a></li></ul></div>':'';}onSession(NavFor);ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>