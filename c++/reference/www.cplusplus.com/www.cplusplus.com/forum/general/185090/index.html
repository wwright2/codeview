<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Determining probability of finding exit - C++ Forum</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/forum/">Forum</a></li>
<li><a href="/forum/general/">General C++ Programming</a></li>
<li class="here">Determining probability of finding exit</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div class="C_support">
<div id='div-gpt-ad-1427191279638-0' style='width:728px; height:90px;'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1427191279638-0'); });
</script>
</div>
</div>
<div id="I_content">
<h3><div class="C_ico question" title="question">&nbsp;</div> Determining probability of finding exit</h3><span id="CH_edttl"></span><span class="rootdatPost" title="185090,root,0,-1,2,0"></span><div id="CH_PostList"><div class="C_forPost" id="msg904107"><span title="904107,213272,255,1,1"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg904107" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm82aab5a2d6" title="Sun, 21 Feb 2016 15:02:42 +0000"></span><script type="text/javascript">WhenId('CH_zTm82aab5a2d6');</script><noscript>Feb 21, 2016 at 3:02pm UTC</noscript></div>
<div class="dwho"><a href="/user/Himpok1990/"><b>Himpok1990</b> (1)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i904107">
Hey guys,<br>
<br>
I've got the task to write a program which reads a kinda maze from a .txt file and marks the fields from which a person starting there could reach an exit. However there's a catch. When starting and everytime the person hits a wall, it randomly decides in which direction it will continue. Now for a maze like this:<br>
<a href="https://gyazo.com/56560db0a2f0d6b3e27bf7e1c3aa42d4">https://gyazo.com/56560db0a2f0d6b3e27bf7e1c3aa42d4</a><br>
the areas where the probability of finding an exit is 100% are marked green (I know it looks bad ;) . In every other case the person could end up in an infinite loop.<br>
<br>
I have quite a bit of the program working, it finds allt he points I've marked above, but it also finds some more...<br>
I would really appreciate it if somebody could have a look at the code I've got so far :).<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>98<br>99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185<br>186<br>187<br>188<br>189<br>190<br>191<br>192<br>193<br>194<br>195<br>196<br>197<br>198<br>199<br>200<br>201<br>202<br>203<br>204<br>205<br>206<br>207<br>208<br>209<br></code></pre></td>
<td class="source"><pre><code><dfn>#include &lt;iostream&gt;                             </dfn>
<dfn>#include &lt;fstream&gt;                              </dfn>
<dfn>#include &lt;string&gt;</dfn>
<dfn>#include &lt;sstream&gt;</dfn>
<dfn>#include &lt;vector&gt;</dfn>
<dfn>#include "random.cpp"</dfn>



<var>typedef</var> std::vector&lt;std::vector&lt;<var>char</var>&gt;&gt; field_type;


<var>struct</var> vek
	{
		<var>int</var> y, x;
	};

vek <var>operator</var>+(vek a, vek b)   
{                                                            
	vek ret;
	ret.x= a.x + b.x;
	ret.y = a.y + b.y;
	<var>return</var> ret;
}


<var>void</var> init(std::string filename);
<var>void</var> start(field_type&amp; vector, field_type&amp; winner, <var>int</var> remCells);
<var>void</var> output(field_type vector, field_type winner);
<var>bool</var> test(field_type&amp; vector, vek position, <var>int</var> r, vek Dir[]);
																	

<var>int</var> main()
{
	std::string filename;

	std::cout &lt;&lt; <kbd>"Please tell me the name of the file (with .txt):"</kbd>&lt;&lt;std::endl;
	std::cin &gt;&gt; filename;	
	
	init(filename);
	
	std::cin.ignore();
	std::cin.get();
	<var>return</var> 0;
}

<var>void</var> init(std::string filename)
{

	<var>int</var> remCells = 0; 
	std::ifstream File;  
	File.open(filename, std::ios::in);


		
		<var>while</var>(!File)
		{
			std::cout &lt;&lt; <kbd>"Error: File not found!\n\n"</kbd>;
			std::cout &lt;&lt; <kbd>"Please tell me the name of the file (with .txt):"</kbd>&lt;&lt;std::endl;
			std::cin &gt;&gt; filename;
			File.open(filename, std::ios::in);
		}

     
		
		std::string line;
		std::string buffer; 
		<var>int</var> height = 0;
		<var>int</var> width = 0;

		<var>while</var> (File.good()) 
		{              
			
			std::getline(File, line);	
			buffer += line;
			height++;
		}
		width = line.length();
		
		field_type vector(height, std::vector&lt;<var>char</var>&gt;(width)); 
	    feld_typ winner(height, std::vector&lt;<var>char</var>&gt;(width));

		<var>int</var> i = 0;
		<var>for</var> ( <var>int</var> j = 0; j &lt; heigth; j++)
		{

			<var>for</var> ( <var>int</var> k = 0; k &lt; width; k++)
			{
				vector[j][k] = buffer[i];
				std::cout &lt;&lt; vector[j][k];
				<var>if</var>(vector[j][k] == <kbd>' '</kbd>) remCells++;
				winner[j][k] = vector[j][k];
				i++;
			}
			std::cout &lt;&lt; std::endl;
		}
		std::cout &lt;&lt; std::endl;
	
	std::cin.ignore();
	std::cin.get();
	start(vector, winner, remCells);

}

<var>void</var> start(field_type&amp; vector, field_type&amp; winner, <var>int</var> remCells)
{
	
	
	vek Dir[] = { {0,-1}, {0,1}, {1,0}, {-1,0} };
	vek position;
	<var>int</var> z = 1;
	<var>bool</var> north, south, east, west;
	
	<var>while</var>(remCells &gt; 0)
	{

		<var>for</var>(<var>int</var> i = 0; i &lt; vector.size(); i++)
		{
			<var>for</var> (<var>int</var> j = 0; j &lt; vector[i].size(); j++)
			{
				<var>if</var> (vector[i][j] == <kbd>' '</kbd>)
				{
					position.x = j;
					position.y = i;
					
					north = test(vector, position, 0, Dir);
					south = test(vector, position, 1, Dir);
					east = test(vector, position, 2, Dir);
					west = test(vector, position, 3, Dir);
		
					<var>if</var> ( north &amp;&amp; south &amp;&amp; east &amp;&amp; west) winner[i][j] = <kbd>'G'</kbd>;
					
					remCells--;
					<var>for</var>(<var>int</var> k = 0; k &lt; vector.size(); k++)
					{
						<var>for</var> (<var>int</var> l = 0; l &lt; vector[k].size(); l++)
						{
							<var>if</var>(vector[k][l]== <kbd>'.'</kbd>)
							{
								vector[k][l] = <kbd>' '</kbd>;
							}
						}		
					}
				}
			}
		}
	}
	output(vector,winner);
}


<var>bool</var> test(field_type&amp; vector, vek position, <var>int</var> r, vek Dir[])
{
	<var>bool</var> exit = <var>false</var>;
	<var>int</var> alreadyVisited = 0;
	<var>do</var>{
						vector[position.y][position.x] = <kbd>'.'</kbd>;
								
						<var>if</var> (vector[position.y + Dir[r].y][position.x + Dir[r].x] == <kbd>'#'</kbd>)
						{
							r = Random::rnd(0,3);
						}
						<var>else</var>
						{
							position = position + Dir[r];
						}
						<var>if</var>(vector[position.y][position.x] == <kbd>'.'</kbd>)
						{
							alreadyVisited++;
						}
						<var>if</var>(vector[position.y][position.x] == <kbd>'E'</kbd>)
						{
							exit = <var>true</var>;
							<var>break</var>;
						}
					} <var>while</var>(alreadyVisited &lt; 100000);
	<var>return</var> exit;

}


<var>void</var> output(field_type vector, field_type winner)
{
	<var>for</var> ( <var>int</var> j = 0; j &lt; vector.size(); j++)
		{

			<var>for</var> ( <var>int</var> k = 0; k &lt; vector[j].size(); k++)
			{
				std::cout &lt;&lt; vector[j][k];
			}

			std::cout &lt;&lt; std::endl;
		}
		std::cout &lt;&lt; std::endl;

		std::cout &lt;&lt; std::endl &lt;&lt; std::endl &lt;&lt; <kbd>"WINNERS"</kbd>&lt;&lt; std::endl&lt;&lt; std::endl;
		
		<var>for</var> ( <var>int</var> j = 0; j &lt; vector.size(); j++)
		{

			<var>for</var> ( <var>int</var> k = 0; k &lt; vector[j].size(); k++)
			{
				std::cout &lt;&lt; winner[j][k];
			}

			std::cout &lt;&lt; std::endl;
		}
		std::cout &lt;&lt; std::endl &lt;&lt; std::endl;
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>

</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTm71e3f6b606" title="Sun, 21 Feb 2016 15:08:15 +0000"></span><script type="text/javascript">WhenId('CH_zTm71e3f6b606');</script><noscript>Feb 21, 2016 at 3:08pm UTC</noscript></span>
<span class="dbtn" id="CH_btn904107"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg905138"><span title="905138,9110,5119,10134,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg905138" title="Link to this post"><img src="/img/link.png" width="16" height="8"></a> <span id="CH_zTm50c7bf53f3" title="Thu, 25 Feb 2016 04:17:07 +0000"></span><script type="text/javascript">WhenId('CH_zTm50c7bf53f3');</script><noscript>Feb 25, 2016 at 4:17am UTC</noscript></div>
<div class="dwho"><a href="/user/Duoas/"><b>Duoas</b> (10134)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i905138">
I get no output for this at all... (after fixing some typos -- you should cut and paste working examples when you post).<br>
<br>
I haven't looked too hard at it, but I do notice you are using a PRNG in there... <br>
<i>Don't</i>. <br>
The solution to this problem is deterministic. <br>
<br>
The idea is weird at first glance, but simple:<br>
If someone trying to solve the maze chooses a random direction to walk at each juncture (every time he is forced to turn because he hit a wall), the possibility of exiting should <i>always</i> exist.<br>
<br>
Let's consider a few scenarios:<br>
<br>
(1)<br>
Our first scenario we start at the solid brick and follow in one direction until forced to turn.<br>
It is simple enough: we have two possible directions to choose, and at each turn two again -- one of which is back the way we started. No matter how long we spend going back and forth on the top row, the instant we "randomly" turn south we will walk into an exit.<br>
<div class="auto"><table class="snippet"><tr><td class="output"><pre><samp># # # # # # # # # # # #
#   # ┌───█─────┐ #   #
#     │ # #     │     #
#     │ #       E #   #
#     │         # #   #
#     │               #
#   # E         E # # #
# # # # # # # # # # # #</samp></pre></td></tr></table></div><br>
<br>
(2)<br>
Our second scenario is similar. The only difference is that at each juncture we have more decisions. At no point, however, does any decision lead us into a path where we cannot eventually find our way to an exit.<br>
<div class="auto"><table class="snippet"><tr><td class="output"><pre><samp># # # # # # # # # # # #
#   # ┌───────┬─┐ #   #
#     │ # #   │ │     #
#     │ # ┌───█─E #   #
#     │   │   │ # #   #
#     │   │   │       #
#   # E───┴───┴─E # # #
# # # # # # # # # # # #</samp></pre></td></tr></table></div><br>
<br>
(3)<br>
Our final scenario starts us at a bad position.<br>
While it is very similar to our last starting position -- it does indeed present the random possibility of finding an exit -- it <i>also</i> presents the possibility of wandering off the the left side of the board, where, as we can see, there is no escape. (Remember, in order to turn, you must first walk into a wall. So it is possible to get there, but unless you "randomly" turn immediately back the way you came, you cannot get out.)<br>
<div class="auto"><table class="snippet"><tr><td class="output"><pre><samp># # # # # # # # # # # #
# ║ # ┌───────┬─┐ #   #
# ║   │ # #   │ │     #
# ║   │ #     │ E #   #
# ╟─────┬─────┤ # #   #
# ║   │ │     │       #
# ║ # E─█─────┴─E # # #
# # # # # # # # # # # #</samp></pre></td></tr></table></div><small><i>You can check in any time you like, but you can never leave.</i></small><br>
<br>
In order to find those spots on the board where the only possibility is successful exit, you <i>must</i> follow <i>every</i> path available from your start position.<br>
<br>
Using the first example, we start at (1,5).<br>
Then we follow <i>all</i> possible directions. <br>
To the west, we go to (1,3), then down to (6,3) which is an exit.<br>
To the east, we go to (1,8), then down to (3,8) which is also an exit.<br>
Having followed every path from every juncture we have verified that <i>all paths lead to exit</i>.<br>
<br>
Hopefully this has suggested something to you:<br>
<br>
<br>
TL;DR:<br>
In order to solve this, you should be thinking of your maze as a <i>graph</i> and use a search algorithm on it (DFS or BFS, either will do):<br>
<tt>    •</tt> If <i>all</i> the leaves in your search yield exits, then your start position is golden. <br>
<tt>    •</tt> If <i>any</i> leaf in your search yields a dead end, then your start position is no good.<br>
<br>
This is a fairly brute-force solution. In more advanced algorithms courses you can learn about stuff that can do it more efficiently, but don't worry any about that...<br>
<br>
Hope this helps.
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn905138"></span>

</div>
</div>
</div>
</div><div class="rootinsMore"></div><div class="rootbtnMore"></div><div class="rootinsNew"></div><div class="rootbtnNew"></div><div id="CH_insNew"></div><div id="CH_reply">Registered users can post here. <a href="/user/">Sign in or register</a> to post.</div><div id="CH_subscription"></div><div class="rootedtNew"></div><script type="text/javascript">new for_PostList(185090,0,213272,0,'CH_PostList','CH_subscription','CH_reply','CH_insNew','CH_edttl','/forum/thread.cgi','/forum/post.cgi','/forum/myposts.cgi',64,32,512,256,1024,16);</script></div>
<script type="text/javascript">
    google_ad_client = "ca-pub-1444228343479937";
    google_ad_slot = "9701143201";
    google_ad_width = 728;
    google_ad_height = 90;
</script>
<!-- leaderboard -->
<script type="text/javascript"
src="//pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder articles"><a href="/articles/">Articles</a></li>
<li class="folder selected forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/forum/">Forum</a></b></h3>
<ul>
<li><a href="/forum/beginner/"><b>Beginners</b></a></li><li><a href="/forum/windows/"><b>Windows Programming</b></a></li><li><a href="/forum/unices/"><b>UNIX/Linux Programming</b></a></li><li class="selected"><a href="/forum/general/"><b>General C++ Programming</b></a></li><li><a href="/forum/lounge/"><b>Lounge</b></a></li><li><a href="/forum/jobs/"><b>Jobs</b></a></li></ul>
</div>
<div id="I_subnav"></div>
<div class="C_ad234">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7445514729";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Fforum%2Fgeneral%2F185090%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
function NavFor(us) {document.getElementById('I_subnav').innerHTML=us.ok?'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul><li><a href="/forum/myposts.cgi">My topics</a></li></ul></div>':'';}onSession(NavFor);ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>