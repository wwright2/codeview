<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Debugging using gdb: Find a segFault - C++ Articles</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/articles/">Articles</a></li>
<li class="here">Debugging using gdb: Find a segFault</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div id="I_content">
<div class="C_art">
<div id="I_author">Published by <b><a href="/user/Moschops/" rel="author">Moschops</a></b></div>
<div id="I_date">Aug 15, 2012 (last update: Aug 15, 2012)</div>
<h1>Debugging using gdb: Find a segFault</h1>
<div id="I_score">Score: 3.9/5 (185 votes)</div>
<div id="I_stars"><img src="/ico/16star.png" width="16" height="16" alt="*"><img src="/ico/16star.png" width="16" height="16" alt="*"><img src="/ico/16star.png" width="16" height="16" alt="*"><img src="/ico/16star-half.png" width="16" height="16" alt="*"><img src="/ico/16star-empty.png" width="16" height="16" alt="*"></div>
<div id="I_content">
To get started with gdb, short examples are good. Once you know how to run it (gdb nameOfProgram), how to examine and traverse the stack (bt, up, down), see the code you're currently in (list) and how to get the values of variables (print) you're equipped to deal with the most common crashes (i.e. segFaults) and you've bootstrapped yourself to the point that you can learn more yourself.<br>
<br>
Here's a sample session:<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br></code></pre></td>
<td class="source"><pre><code><dfn>#include&lt;iostream&gt;</dfn>
<var>using</var> <var>namespace</var> std;

<var>int</var> main()
{

  <var>int</var> x = 7;
  <var>int</var> *p = 0;

  cout &lt;&lt; <kbd>"x = "</kbd> &lt;&lt; x;
  cout &lt;&lt; <kbd>"The pointer points to the value "</kbd> &lt;&lt; *p;
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Wrote some code, now I'll build it and run. What I type is in bold, what's on the screen is in italics.<br>
<br>
<EM>j@j-desktop:~/badCode$</EM> <b>g++ 227.cpp</b>
<br>
<EM>j@j-desktop:~/badCode$</EM> <b>./a.out </b>
<br>
<EM>Segmentation fault</EM>
<br>
<br>
Oh no, a segfault. I'll rebuild it with debugging symbols and then run it under the debugger.<br>
<br>
<EM>j@j-desktop:~/badCode$</EM> <b>g++ -g 227.cpp</b>
<br>
<EM>j@j-desktop:~/badCode$</EM> <b>gdb ./a.out </b>
<br>
<EM>GNU gdb (GDB) 7.1-ubuntu<br>
Copyright (C) 2010 Free Software Foundation, Inc.<br>
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;<br>
This is free software: you are free to change and redistribute it.<br>
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"<br>
and "show warranty" for details.<br>
This GDB was configured as "x86_64-linux-gnu".<br>
For bug reporting instructions, please see:<br>
&lt;http://www.gnu.org/software/gdb/bugs/&gt;...<br>
Reading symbols from /home/j/badCode/a.out...done.<br>
(gdb)</EM> <b>run</b>
<br>
<EM>Starting program: /home/j/badCode/a.out <br>
<br>
Program received signal SIGSEGV, Segmentation fault.<br>
0x0000000000400824 in main () at 227.cpp:13<br>
13	  cout &lt;&lt; "The pointer points to the value " &lt;&lt; *p;</EM>
<br>
<br>
<br>
Thoughts: Well, the segFault happens on this line. I'm using a pointer here, p. I'd better check the value of that pointer.<br>
<br>
<EM>(gdb)</EM> <b>print p</b>
<br>
<EM>$1 = (int *) 0x0</EM>
<br>
Thoughts:Aha! The pointer has a value of zero - it's a null pointer. Trying to dereference it is causing a segFault. Let's see the nearby code.<br>
<br>
<EM>(gdb)</EM> <b> list</b>
<br>
<EM> int x = 7;<br>
 int *p = 0;<br>
<br>
 cout &lt;&lt; "x = " &lt;&lt; x;<br>
 cout &lt;&lt; "The pointer points to the value " &lt;&lt; *p;<br>
}</EM>
<br>
<br>
<br>
<br>
Thoughts: Ah, I never set the pointer to point at anything. That's easily fixed.<br>
<br>
<EM>(gdb)</EM> <b>quit</b>
<EM>A debugging session is active.<br>
<br>
	Inferior 1 [process 6779] will be killed.<br>
<br>
Quit anyway? (y or n) </EM>
<br>
<br>
Fix the code:<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br></code></pre></td>
<td class="source"><pre><code><dfn>#include&lt;iostream&gt;</dfn>

<var>using</var> <var>namespace</var> std;

<var>int</var> main()
{

  <var>int</var> x = 7;
  <var>int</var> *p = 0;
  p = &amp;x;

  cout &lt;&lt; <kbd>"x = "</kbd> &lt;&lt; x;
  cout &lt;&lt; <kbd>"The pointer points to the value "</kbd> &lt;&lt; *p;
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Now build and run:<br>
<EM>j@j-desktop:~/badCode$</EM><b> g++ 227.cpp</b>
<br>
<EM>j@j-desktop:~/badCode$</EM><b> ./a.out</b>
<br>
<EM>x = 7The pointer points to the value 7</EM>
<br>
<br>
So there we have it. The commands I used were:<br>
<br>
<b>gdb ./a.out</b> - Start gdb attached to the program I'm interested in. This does not start the program running.<br>
<b>run</b> - Start program running<br>
<b>print p</b> - Show me the value of the object named p.<br>
<b>list</b> - Show the line that execution has paused at, and surrounding lines of code.<br>
<b>quit</b> - Exit gdb.<br>
<br>
I suggest you do something similar yourself to practice a little. SegFaults are wonderfully easy to track down like this. Literally thirty seconds with gdb can identify the exact problem. I've seen people spend hours trying to do it by hand, staring at the code, printlining variables all over the place, just because they didn't want to get into the debugger.</div></div><div id="CH_bb"></div><div id="CH_scoreapp"></div><script type="text/javascript">new Score('CH_scoreapp','/articles/score.cgi','iwTbqMoL');</script></div>
</div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder selected articles"><a href="/articles/">Articles</a></li>
<li class="folder forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/articles/">Articles</a></b></h3>
<ul>
<li><a href="/articles/algorithms/">Algorithms</a></li><li><a href="/articles/cpp11/">C++ 11</a></li><li><a href="/articles/graphics/">Graphics and multimedia</a></li><li><a href="/articles/howto/">How-To</a></li><li><a href="/articles/language/">Language Features</a></li><li><a href="/articles/linux/">Unix/Linux programming</a></li><li><a href="/articles/sourcecode/">Source Code</a></li><li><a href="/articles/standard_library/">Standard Library</a></li><li><a href="/articles/tips/">Tips and Tricks</a></li><li><a href="/articles/tools/">Tools and Libraries</a></li><li><a href="/articles/visualcpp/">Visual C++</a></li><li><a href="/articles/winapi/">Windows API</a></li></ul>
</div>
<div id="I_subnav"></div>
</div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Farticles%2FiwTbqMoL%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
onSession(function(us) {
		document.getElementById('I_subnav').innerHTML=
			us.ok?
				'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul>'+
				'<li><a href="/articles/myitems.cgi">My items</a></li>'+
				(us.auth(32768)?'<li><a href="/articles/adminitems.cgi">Admin items</a></li>':'')+
				'</ul></div>'
			:'';
	}); onSession(function (us) {
		var el=document.getElementById('CH_bb'); el.innerHTML='';
		if ( (us.auth(32768)) || ((us.uniqid=='413pX9L8')&&(us.auth(128))) ) {
			el.appendChild(btn('Edit article','Edit this version of the article','edit','/articles/edit.cgi?a=iwTbqMoL'));
	
			if (us.auth(32768)) {
				el.appendChild(btn('Delete article','Delete this article','delete','javascript:artdel()'));
			}
	
		}
	});
	function artdel() { if (confirm('WARNING: You are about to delete this page. Confirm?')) window.location='/articles/delete.cgi?a=iwTbqMoL'; }
	ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>