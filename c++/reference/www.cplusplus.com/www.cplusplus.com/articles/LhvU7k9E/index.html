<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Using HMENU - C++ Articles</title>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="/v321/main.css">
<script src="/v321/main.js" type="text/javascript"></script>
<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.defineSlot('/32882001/L', [728, 90], 'div-gpt-ad-1427191279638-0').addService(googletag.pubads());
googletag.enableServices();
});
</script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="/" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="/articles/">Articles</a></li>
<li class="here">Using HMENU</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div id="I_content">
<div class="C_art">
<div id="I_author">Published by <b><a href="/user/Smarty/" rel="author">Smarty</a></b></div>
<div id="I_date">May 29, 2012 (last update: May 29, 2012)</div>
<h1>Using HMENU</h1>
<div id="I_score">Score: 3.8/5 (76 votes)</div>
<div id="I_stars"><img src="/ico/16star.png" width="16" height="16" alt="*"><img src="/ico/16star.png" width="16" height="16" alt="*"><img src="/ico/16star.png" width="16" height="16" alt="*"><img src="/ico/16star-half.png" width="16" height="16" alt="*"><img src="/ico/16star-empty.png" width="16" height="16" alt="*"></div>
<div id="I_content">
Some of you probably have a program you are working on, or even just have an idea for one. So, I will teach you how to make a professional looking program by adding in a pop down menu, and even teach you how to make it do basic stuff if you click the drop down menu's item<br>
<br>
First off, you find the section where you will be putting your code to make your menu.<br>
<br>
You will want to put just under your <span class="auto"><code class="source"><var>switch</var> (message)</code></span> part of your code.<br>
<br>
So, you will need to tell it what <span class="auto"><code class="source"><var>case</var></code></span> it is in. in this instance, it will be in the <span class="auto"><code class="source"><var>case</var> WM_CREATE</code></span>. so, write it out like this:<br>
<br>
<span class="auto"><code class="source"><var>case</var> WM_CREATE:</code></span>
<br>
Next, you will declare all the menu's contained in the one menu at the top of your screen. For this, we will use the <span class="auto"><code class="source">CreateMenu</code></span> function for creating the menu. Your code should look like this:<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br></code></pre></td>
<td class="source"><pre><code>HMENU hMenubar = CreateMenu();
HMENU hFile = CreateMenu();
HMENU hEdit = CreateMenu();
HMENU hHelp = CreateMenu();</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Now, the hMenubar will end up being the strip along the top of our program that will hold the other drop down menus. The rest of the menus declared will be the titles of the drop down menus.<br>
<br>
Now we will use AppendMenu to place the menus<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br></code></pre></td>
<td class="source"><pre><code>AppendMenu(hMenubar, MF_POPUP, (UINT_PTR)hFile, <kbd>"File"</kbd>);           
AppendMenu(hMenubar, MF_POPUP, (UINT_PTR)hEdit, <kbd>"Edit"</kbd>);
AppendMenu(hMenubar, MF_POPUP, (UINT_PTR)hHelp, <kbd>"Help"</kbd>); </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
You don't have to AppendMenu the hMenubar, but you do have to say that the pop down menu titles are going to be on it. You can actually name the hMenubar anything you want, but you need to say the same name that you named it all through your code. You can also name your pop down menu titles anything you want also. But the same applies to those as it did the hMenubar.<br>
<br>
Continuing on:<br>
Making items for the pop down menus<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br></code></pre></td>
<td class="source"><pre><code>AppendMenu(hFile, MF_STRING, ID_Save, <kbd>"Save"</kbd>);
AppendMenu(hFile, MF_STRING, ID_Load, <kbd>"Load"</kbd>);
AppendMenu(hFile, MF_STRING, ID_Exit, <kbd>"Exit"</kbd>);
               
AppendMenu(hEdit, MF_STRING, ID_Undo, <kbd>"Undo"</kbd>);
AppendMenu(hEdit, MF_STRING, ID_Redo, <kbd>"Redo"</kbd>);
                
AppendMenu(hHelp, MF_STRING, ID_VWS, <kbd>"Visit website"</kbd>); </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Now, that was just saying what is going to be in the menu.<br>
Save will be in hFile because it says hFile at the beginning of the commass.<br>
<br>
Next, you might notice the ID_Save, ID_Load, and all of those. We can not compile it like this at the moment, you would have to change all the ID's to just NULL like so: <span class="auto"><code class="source">]MF_STRING, NULL, <kbd>"Save"</kbd>);</code></span>
<br>
But if you have NULL then you have no way of giving it a command when it is clicked.<br>
<br>
So, go back in your code to right after:<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br></code></pre></td>
<td class="source"><pre><code><var>return</var> messages.wParam;
} </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
and then do this:<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br></code></pre></td>
<td class="source"><pre><code><dfn>#define ID_Save 1</dfn>
<dfn>#define ID_Load 2</dfn>
<dfn>#define ID_Exit 3</dfn>
<dfn>#define ID_Undo 4</dfn>
<dfn>#define ID_Redo 5</dfn>
<dfn>#define ID_VWS 6  </dfn></code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Now you have only one thing left to do before you can compile it, but it won't do anything if you choose an item from the drop down menu. (Note: you must number your #define's, so do it 1, 2, 3, for each one.)<br>
<br>
Now head back down to under the last AppendMenu you did, and type this in:<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br></code></pre></td>
<td class="source"><pre><code>SetMenu(hwnd, hMenubar);
<var>break</var>;} </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
Now you can compile it and see your pretty drop down menu. Drool over it and come back when you're done drooling.<br>
<br>
Ok, next we program in the commands, so we will declare <span class="auto"><code class="source"><var>case</var> WM_COMMAND:{</code></span>
<br>
Under thta you will start making commands,<br>
<br>
Lets just do some basic commands just to keep this short, it is getting too long already.<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br></code></pre></td>
<td class="source"><pre><code><var>if</var>(LOWORD(wParam) == ID_Exit) {
exit(0); } </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
That is telling it to exit when you click the button with the ID_Exit on it.<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br></code></pre></td>
<td class="source"><pre><code><var>if</var>(LOWORD(wParam) == ID_VWS) {
ShellExecute(NULL, <kbd>"Open"</kbd>, <kbd>"http://www.yoursitehere.com/"</kbd>, NULL, NULL, SW_SHOWNORMAL);} </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Now, this is saying: if you click the button with ID_VWS, then link to where ever it says to link to with your default browser.<br>
<br>
You can also do ShellExecute on files, but it only brings up the file with the default thing it opens with (for example: .txt would open in notepad, or what ever you set it to open with)<br>
<br>
You can just change the web link to: <div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>&nbsp;</code></pre></td>
<td class="source"><pre><code><kbd>"C:\\Users\\{username}\\Desktop\\{Filename}.txt"</kbd> </code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
and it will open that file when you push the button<br>
<br>
I have attached the main.cpp so you ca mess around in the code.<p>Attachments:
	[<a href="main.cpp">main.cpp</a>]
</p>
</div></div><div id="CH_bb"></div><div id="CH_scoreapp"></div><script type="text/javascript">new Score('CH_scoreapp','/articles/score.cgi','LhvU7k9E');</script></div>
</div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="/">C++</a></b></h3>
<ul>
<li class="folder info"><a href="/info/">Information</a></li>
<li class="folder doc"><a href="/doc/">Tutorials</a></li>
<li class="folder reference"><a href="/reference/">Reference</a></li>
<li class="folder selected articles"><a href="/articles/">Articles</a></li>
<li class="folder forum"><a href="/forum/">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="/articles/">Articles</a></b></h3>
<ul>
<li><a href="/articles/algorithms/">Algorithms</a></li><li><a href="/articles/cpp11/">C++ 11</a></li><li><a href="/articles/graphics/">Graphics and multimedia</a></li><li><a href="/articles/howto/">How-To</a></li><li><a href="/articles/language/">Language Features</a></li><li><a href="/articles/linux/">Unix/Linux programming</a></li><li><a href="/articles/sourcecode/">Source Code</a></li><li><a href="/articles/standard_library/">Standard Library</a></li><li><a href="/articles/tips/">Tips and Tricks</a></li><li><a href="/articles/tools/">Tools and Libraries</a></li><li><a href="/articles/visualcpp/">Visual C++</a></li><li><a href="/articles/winapi/">Windows API</a></li></ul>
</div>
<div id="I_subnav"></div>
</div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="/">Home page</a> | <a href="/privacy.do">Privacy policy</a><br>&copy; cplusplus.com, 2000-2016 - All rights reserved - <i>v3.1</i><br><a href="/contact.do?referrer=www.cplusplus.com%2Farticles%2FLhvU7k9E%2F">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
onSession(function(us) {
		document.getElementById('I_subnav').innerHTML=
			us.ok?
				'<div class="sect"><h3><b><a href="/user/">'+us.user+'</a></b></h3><ul>'+
				'<li><a href="/articles/myitems.cgi">My items</a></li>'+
				(us.auth(32768)?'<li><a href="/articles/adminitems.cgi">Admin items</a></li>':'')+
				'</ul></div>'
			:'';
	}); onSession(function (us) {
		var el=document.getElementById('CH_bb'); el.innerHTML='';
		if ( (us.auth(32768)) || ((us.uniqid=='jyhC5Di1')&&(us.auth(128))) ) {
			el.appendChild(btn('Edit article','Edit this version of the article','edit','/articles/edit.cgi?a=LhvU7k9E'));
	
			if (us.auth(32768)) {
				el.appendChild(btn('Delete article','Delete this article','delete','javascript:artdel()'));
			}
	
		}
	});
	function artdel() { if (confirm('WARNING: You are about to delete this page. Confirm?')) window.location='/articles/delete.cgi?a=LhvU7k9E'; }
	ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>